/**
 * Validation Rules for User resource
 */
import { body } from 'express-validator'
import { getUserById } from '../services/user_service'

export const createPhotoRules = [
	body('title').isString().bail().isLength({ min: 1 }),
	body('url').exists().isString().bail().isLength({ min: 3 }),
	body('userId').isEmail().custom(async (value: number) => {
		// check if a User with that id exisits
		const user = await getUserById(value)

		if (!user) {
			// user doesn't exists
			return Promise.reject("User doesn't exist exists")
		}
	}),
	body('comment').optional().isString().bail(),
]